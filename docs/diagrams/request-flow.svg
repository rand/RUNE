<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 500" width="600" height="500">
  <defs>
    <style>
      .box { fill: #f5f5f5; stroke: #7B1FA2; stroke-width: 2; }
      .text { font-family: 'JetBrains Mono', monospace; font-size: 14px; fill: #000; }
      .arrow { stroke: #666; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .label { font-family: 'Geist', sans-serif; font-size: 12px; fill: #666; }
      @media (prefers-color-scheme: dark) {
        .box { fill: #1a1a1a; stroke: #9C27B0; }
        .text { fill: #ededed; }
        .arrow { stroke: #888; }
        .label { fill: #888; }
      }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#666"/>
    </marker>
  </defs>

  <!-- Step 1 -->
  <rect class="box" x="50" y="20" width="500" height="60" rx="6"/>
  <text class="text" x="300" y="55" text-anchor="middle">1. Agent makes request</text>

  <!-- Arrow -->
  <path class="arrow" d="M 300 80 L 300 110"/>

  <!-- Step 2 -->
  <rect class="box" x="50" y="110" width="500" height="60" rx="6"/>
  <text class="text" x="300" y="145" text-anchor="middle">2. RUNE Engine receives request</text>

  <!-- Arrow -->
  <path class="arrow" d="M 300 170 L 300 200"/>

  <!-- Step 3 -->
  <rect class="box" x="50" y="200" width="500" height="60" rx="6"/>
  <text class="text" x="300" y="235" text-anchor="middle">3. Build context from facts</text>

  <!-- Arrow -->
  <path class="arrow" d="M 300 260 L 300 290"/>

  <!-- Step 4 - Parallel evaluation -->
  <rect class="box" x="50" y="290" width="240" height="80" rx="6"/>
  <text class="text" x="170" y="320" text-anchor="middle" font-size="12">Datalog Engine</text>
  <text class="text" x="170" y="340" text-anchor="middle" font-size="12">evaluates rules</text>
  <text class="label" x="170" y="360" text-anchor="middle">→ Derived facts</text>

  <rect class="box" x="310" y="290" width="240" height="80" rx="6"/>
  <text class="text" x="430" y="320" text-anchor="middle" font-size="12">Cedar Engine</text>
  <text class="text" x="430" y="340" text-anchor="middle" font-size="12">evaluates policies</text>
  <text class="label" x="430" y="360" text-anchor="middle">→ Authorization decision</text>

  <!-- Merge arrows -->
  <path class="arrow" d="M 170 370 L 170 410 L 300 410"/>
  <path class="arrow" d="M 430 370 L 430 410 L 300 410"/>

  <!-- Step 5 -->
  <rect class="box" x="50" y="420" width="500" height="60" rx="6"/>
  <text class="text" x="300" y="455" text-anchor="middle">5. Merge results</text>

  <!-- Title -->
  <text class="label" x="10" y="15" font-size="16" font-weight="600">Request Flow</text>
</svg>
